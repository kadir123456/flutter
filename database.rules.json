{
  "rules": {
    ".read": false,
    ".write": false,
    
    // ============================================
    // ğŸ”’ KULLANICILAR (USERS)
    // ============================================
    "users": {
      "$uid": {
        // âœ… Okuma: KullanÄ±cÄ± kendi verisini okuyabilir
        ".read": "$uid === auth.uid",
        
        // âœ… YENÄ° KAYIT + GÃœNCELLEME
        ".write": "$uid === auth.uid && auth != null && (
          // Yeni kayÄ±t: Veri yoksa oluÅŸturabilir
          !data.exists() ||
          // GÃ¼ncelleme: Veri varsa gÃ¼ncelleyebilir
          data.exists()
        )",
        
        // âš ï¸ KREDÄ° VALIDATION
        "credits": {
          ".validate": "newData.isNumber() && 
                        newData.val() >= 0 && 
                        newData.val() <= 10000 &&
                        (
                          !data.exists() ||  // ğŸ†• Yeni kayÄ±tta validation geÃ§sin
                          newData.val() <= data.val() ||  // Azaltma (kullanÄ±m)
                          newData.val() === data.val() + 1 ||  // +1 reklam
                          newData.val() === data.val() + 3 ||  // +3 hoÅŸgeldin
                          newData.val() === data.val() + 5 ||  // +5 paket
                          newData.val() === data.val() + 10 ||  // +10 paket
                          newData.val() === data.val() + 12 ||  // +10 + 2 bonus
                          newData.val() === data.val() + 25 ||  // +25 paket
                          newData.val() === data.val() + 30 ||  // +25 + 5 bonus
                          newData.val() === data.val() + 50 ||  // +50 paket
                          newData.val() === data.val() + 65 ||  // +50 + 15 bonus
                          newData.val() === data.val() + 100   // +100 paket
                        )"
        },
        
        // âš ï¸ PREMIUM VALIDATION
        "isPremium": {
          ".validate": "newData.isBoolean() && (
                          !data.exists() ||  // ğŸ†• Yeni kayÄ±tta validation geÃ§sin
                          newData.val() == false || 
                          (newData.val() == true && data.val() == false)
                        )"
        },
        
        // âš ï¸ PREMIUM EXPIRY VALIDATION
        "premiumExpiresAt": {
          ".validate": "!data.exists() ||  // ğŸ†• Yeni kayÄ±tta validation geÃ§sin
                        (newData.val() === null) || 
                        (newData.isNumber() && newData.val() > now)"
        },
        
        // âš ï¸ ANALÄ°Z SAYISI VALIDATION
        "totalAnalysisCount": {
          ".validate": "newData.isNumber() && 
                        newData.val() >= 0 && (
                          !data.exists() ||  // ğŸ†• Yeni kayÄ±tta validation geÃ§sin
                          newData.val() >= data.val()
                        )"
        }
      }
    },
    
    // ============================================
    // ğŸ“‹ BÃœLTENLER (BULLETINS)
    // ============================================
    "bulletins": {
      ".read": "auth != null",
      ".indexOn": ["userId", "createdAt", "status"],
      
      "$bulletinId": {
        ".read": "auth != null",
        ".write": "auth != null && (
          (!data.exists() && newData.child('userId').val() === auth.uid) ||
          (data.exists() && data.child('userId').val() === auth.uid)
        )"
      }
    },
    
    // ============================================
    // ğŸ’³ KREDÄ° Ä°ÅLEMLERÄ° (CREDIT_TRANSACTIONS)
    // ============================================
    "credit_transactions": {
      ".read": "auth != null",
      ".indexOn": ["userId", "createdAt", "type"],
      
      "$transactionId": {
        ".read": "auth != null",
        ".write": "auth != null && !data.exists() && newData.child('userId').val() === auth.uid"
      }
    },
    
    // ============================================
    // ğŸ›’ SATIN ALMA LOGLARI (PURCHASE_LOGS)
    // ============================================
    "purchase_logs": {
      ".read": "auth != null",
      ".indexOn": ["userId", "createdAt", "verified"],
      
      "$purchaseId": {
        ".read": "auth != null",
        ".write": "auth != null && !data.exists() && newData.child('userId').val() === auth.uid"
      }
    },
    
    // ============================================
    // ğŸ“º REKLAM Ä°ZLEME LOGLARI (AD_WATCH_LOGS)
    // ============================================
    "ad_watch_logs": {
      ".read": "auth != null",
      ".indexOn": ["userId", "createdAt", "adType"],
      
      "$logId": {
        ".read": "auth != null",
        ".write": "auth != null && !data.exists() && newData.child('userId').val() === auth.uid"
      }
    },
    
    // ============================================
    // âš½ MAÃ‡ HAVUZU (MATCH POOL)
    // ============================================
    "matchPool": {
      ".read": true,
      ".write": false,
      ".indexOn": ["timestamp", "date", "status"]
    },
    
    // ============================================
    // ğŸ“Š HAVUZ METADATA
    // ============================================
    "poolMetadata": {
      ".read": true,
      ".write": false
    },
    
    // ============================================
    // âš™ï¸ REMOTE CONFIG
    // ============================================
    "remoteConfig": {
      ".read": true,
      ".write": false
    },
    
    // ============================================
    // ğŸš¨ ÅÃœPHELÄ° AKTÄ°VÄ°TE LOGLARI
    // ============================================
    "suspicious_activity": {
      ".read": false,
      ".write": false,
      ".indexOn": ["userId", "createdAt", "activityType"]
    },
    
    // ============================================
    // ğŸ”” BÄ°LDÄ°RÄ°M TOKEN'LARI
    // ============================================
    "notification_tokens": {
      "$uid": {
        ".read": "$uid === auth.uid",
        ".write": "$uid === auth.uid && auth != null"
      }
    }
  }
}